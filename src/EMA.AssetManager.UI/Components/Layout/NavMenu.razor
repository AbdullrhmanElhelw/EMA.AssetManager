@using Microsoft.AspNetCore.Authorization
@inject NavigationManager Navigation

<MudNavMenu Class="modern-nav-menu">

    <div class="nav-section">
        <div class="section-header" @onclick="ToggleDashboardSection">
            <div class="d-flex align-center justify-space-between w-100">
                <div class="d-flex align-center">
                    <MudIcon Icon="@Icons.Material.Filled.Home" Size="Size.Small" Class="me-2" />
                    <MudText Typo="Typo.subtitle2" Class="section-title">الرئيسية</MudText>
                </div>
                <MudIcon Icon="@Icons.Material.Filled.ExpandMore" Size="Size.Small" Style="@DashboardIconStyle" />
            </div>
        </div>

        @if (_isDashboardExpanded)
        {
            <div class="section-content animated-section">
                <MudNavLink Href="/" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Dashboard" IconColor="Color.Secondary" ActiveClass="active-nav-link">
                    لوحة القيادة
                </MudNavLink>
            </div>
        }
    </div>

    <div class="nav-section">
        <div class="section-header" @onclick="ToggleDefinitionsSection">
            <div class="d-flex align-center justify-space-between w-100">
                <div class="d-flex align-center">
                    <MudIcon Icon="@Icons.Material.Filled.Category" Size="Size.Small" Class="me-2" />
                    <MudText Typo="Typo.subtitle2" Class="section-title">التعريفات والمخازن</MudText>
                </div>
                <MudIcon Icon="@Icons.Material.Filled.ExpandMore" Size="Size.Small" Style="@DefinitionsIconStyle" />
            </div>
        </div>

        @if (_isDefinitionsExpanded)
        {
            <div class="section-content animated-section">
                <MudNavLink Href="/categories" Icon="@Icons.Material.Filled.Class" IconColor="Color.Secondary" ActiveClass="active-nav-link">
                    الفئات والتصنيفات
                </MudNavLink>

                <MudNavLink Href="/items" Icon="@Icons.Material.Filled.Devices" IconColor="Color.Secondary" ActiveClass="active-nav-link">
                    سجل الأصناف
                </MudNavLink>

                <MudNavLink Href="/warehouses" Icon="@Icons.Material.Filled.Store" IconColor="Color.Secondary" ActiveClass="active-nav-link">
                    إدارة المخازن
                </MudNavLink>
            </div>
        }
    </div>

    <div class="nav-section">
        <div class="section-header" @onclick="ToggleOperationsSection">
            <div class="d-flex align-center justify-space-between w-100">
                <div class="d-flex align-center">
                    <MudIcon Icon="@Icons.Material.Filled.Work" Size="Size.Small" Class="me-2" />
                    <MudText Typo="Typo.subtitle2" Class="section-title">العمليات والعهد</MudText>
                </div>
                <MudIcon Icon="@Icons.Material.Filled.ExpandMore" Size="Size.Small" Style="@OperationsIconStyle" />
            </div>
        </div>

        @if (_isOperationsExpanded)
        {
            <div class="section-content animated-section">
                <MudNavLink Href="/assets" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.QrCodeScanner" IconColor="Color.Secondary" ActiveClass="active-nav-link">
                    سجل العهدة والأصول
                </MudNavLink>

                <MudNavLink Href="/assets/import" Icon="@Icons.Material.Filled.UploadFile" IconColor="Color.Secondary" ActiveClass="active-nav-link">
                    استيراد من إكسيل
                </MudNavLink>

                <MudNavLink Href="/transactions" Icon="@Icons.Material.Filled.SwapHoriz" IconColor="Color.Secondary" ActiveClass="active-nav-link">
                    حركة الصرف والإرجاع
                </MudNavLink>

                <MudNavLink Href="/maintenance" Icon="@Icons.Material.Filled.Build" IconColor="Color.Secondary" ActiveClass="active-nav-link">
                    الصيانة والدعم الفني
                </MudNavLink>
            </div>
        }
    </div>

    <div class="nav-section">
        <div class="section-header" @onclick="ToggleReportsSection">
            <div class="d-flex align-center justify-space-between w-100">
                <div class="d-flex align-center">
                    <MudIcon Icon="@Icons.Material.Filled.SettingsSuggest" Size="Size.Small" Class="me-2" />
                    <MudText Typo="Typo.subtitle2" Class="section-title">التقارير والإدارة</MudText>
                </div>
                <MudIcon Icon="@Icons.Material.Filled.ExpandMore" Size="Size.Small" Style="@ReportsIconStyle" />
            </div>
        </div>

        @if (_isReportsExpanded)
        {
            <div class="section-content animated-section">
                <MudNavLink Href="/reports" Icon="@Icons.Material.Filled.Assessment" IconColor="Color.Secondary" ActiveClass="active-nav-link">
                    مركز التقارير
                </MudNavLink>

                <MudNavLink Href="/users" Icon="@Icons.Material.Filled.SupervisedUserCircle" IconColor="Color.Secondary" ActiveClass="active-nav-link">
                    إدارة المستخدمين
                </MudNavLink>
                <MudNavLink Href="/settings" Icon="@Icons.Material.Filled.Settings" IconColor="Color.Secondary" ActiveClass="active-nav-link">
                    إعدادات النظام
                </MudNavLink>
            </div>
        }
    </div>

    <MudDivider Class="my-4" Style="border-color: rgba(197, 160, 89, 0.2);" />

    <div class="quick-access">
        <MudText Typo="Typo.caption" Class="px-4 mb-2" Style="color: rgba(255, 255, 255, 0.5);">
            وصول سريع
        </MudText>

        <div class="d-flex flex-wrap justify-center px-3 gap-2">
            <MudTooltip Text="حركة صرف جديدة">
                <MudIconButton Icon="@Icons.Material.Filled.ArrowUpward" Size="Size.Small" Color="Color.Secondary" Variant="Variant.Outlined" Class="quick-action-btn"
                               OnClick="@(() => Navigation.NavigateTo("/transactions"))" />
            </MudTooltip>

            <MudTooltip Text="استيراد إكسيل">
                <MudIconButton Icon="@Icons.Material.Filled.Upload" Size="Size.Small" Color="Color.Secondary" Variant="Variant.Outlined" Class="quick-action-btn"
                               OnClick="@(() => Navigation.NavigateTo("/assets/import"))" />
            </MudTooltip>

            <MudTooltip Text="تقرير الجرد">
                <MudIconButton Icon="@Icons.Material.Filled.Summarize" Size="Size.Small" Color="Color.Secondary" Variant="Variant.Outlined" Class="quick-action-btn"
                               OnClick="@(() => Navigation.NavigateTo("/reports/inventory"))" />
            </MudTooltip>
        </div>
    </div>
</MudNavMenu>