@page "/items/create"
@namespace EMA.AssetManager.UI.Pages.Items

<PageTitle>إضافة صنف جديد</PageTitle>

<MudContainer MaxWidth="MaxWidth.Medium" Class="mt-8">
    <MudPaper Elevation="3" Class="pa-6 rounded-lg" Style="border-top: 4px solid #C5A059;">
        <div class="mb-6">
            <MudText Typo="Typo.h5" Class="font-bold">تعريف صنف جديد</MudText>
            <MudText Typo="Typo.body2" Color="Color.Secondary">أدخل بيانات الصنف لربطه بالمخازن لاحقاً</MudText>
        </div>

        <MudForm @ref="_form" Model="@_model">
            <MudGrid>
                <MudItem xs="12" md="6">
                    <MudTextField @bind-Value="_model.Code" Label="كود الصنف" Variant="Variant.Outlined"
                                  Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.QrCode"
                                  Required="true" RequiredError="الكود مطلوب" />
                </MudItem>

                <MudItem xs="12" md="6">
                    <MudSelect T="Guid ?"
                               Label="الفئة الرئيسية"
                               Variant="Variant.Outlined"
                               @bind-Value="_selectedCategoryId"
                               AnchorOrigin="Origin.BottomCenter"
                               AdornmentIcon="@Icons.Material.Filled.Category"
                               Clearable="true"
                               Placeholder="-- اختر الفئة --"
                               Required="true"
                               RequiredError="يجب اختيار الفئة">

                        @if (_categories != null)
                        {
                            @foreach (var cat in _categories)
                            {
                                <MudSelectItem Value="@((Guid?)cat.Id)">@cat.Name</MudSelectItem>
                            }
                        }
                    </MudSelect>
                </MudItem>

                <MudItem xs="12">
                    <MudTextField @bind-Value="_model.Name" Label="اسم الصنف" Variant="Variant.Outlined"
                                  Required="true" RequiredError="اسم الصنف مطلوب" />
                </MudItem>

                <MudItem xs="12" md="6">
                    <MudTextField @bind-Value="_model.Unit" Label="وحدة القياس (مثال: قطعة، طقم)" Variant="Variant.Outlined" />
                </MudItem>

                <MudItem xs="12" md="6">
                    <MudNumericField @bind-Value="_model.Quantity" Label="الكمية الافتتاحية" Variant="Variant.Outlined" Min="0" />
                </MudItem>
            </MudGrid>

            <MudDivider Class="my-6" />

            <div class="d-flex justify-end gap-2">
                <MudButton OnClick="Cancel" Variant="Variant.Text">إلغاء</MudButton>
                <MudButton OnClick="Submit" Variant="Variant.Filled" Color="Color.Primary" Disabled="@_processing">
                    @if (_processing)
                    {
                        <MudProgressCircular Size="Size.Small" Indeterminate="true" Class="ms-2" />
                    }
                    حفظ البيانات
                </MudButton>
            </div>
        </MudForm>
    </MudPaper>
</MudContainer>